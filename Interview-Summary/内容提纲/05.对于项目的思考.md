## 对于项目的思考

在项目里主要做了什么

1. 完成文件保存和同步模块，支持离线模式下对文件操作，实现缓存管理避免文件丢失

   * 文件保存流程

     直接覆盖原文件——新的文档生成成功才删除原文件——保存后原文件缓存到cache中

     保存的判断，判断是否进行保存的条件设定

   * 文件同步流程

     手动保存同步时直接比对，处理冲突（冲突不应直接覆盖本地），返回云文件后刷新同步，应用相同规则，并做好

   * 缓存管理和清除（避免文件丢失的方法）

     管理本地文件/文件夹的状态，tag信息，缓存最近浏览记录

2. 实现会员管理模块，包括游客模式和离线下的会员状态管理

   * 离线下会员支持：编写了统一的会员管理模块，切换后台/登录/打开软件/保存/定时刷新用户的会员信息，判断时直接调用统一的判断接口
   * 游客模式的实现：实现用户游客态的管理，游客不使用云，会员功能提示购买会员，游客会员隐式绑定appid，登录后检测游客会员绑定

3. 实现异常收集和分析，包括友盟、Bugly的集成和自定义异常收集

   * 异常收集的原理

     拦截Unix信号和Mach异常并进行处理，可以参考淘宝技术之前分享的一篇崩溃捕获的文章，[Crash分析攻略](https://mp.weixin.qq.com/s/hVj-j61Br3dox37SN79fDQ)

   * 怎么分析一个异常，通过什么方法定位/修改，crash自动符号化平台的搭建。

   * 为了避免异常的发生应该做点什么

   * 自定义异常的用途和收集的内容

   * 成果：最终把崩溃率降到了0.0x%

4. 实现iOS端的适配，包 括不同机型适配，iPad键盘和界面适配，iOS13和iOS14适配解决（深色模式、AppleID登录、相册API的适配，编辑界面自定义主题颜色）

   * 适配遇到的一些特殊问题的处理：
   * 深色模式的适配和自定义颜色的方案比较
   * 相册API的适配和封装

5. 内存泄漏解决和内存占用优化

   * 编辑页强引用导致的内存泄漏，View层次的循环引用和迁移的核心库中存在的循环引用

     分析并处理了闭包中和view层面的循环强引用，部分内核库也修改了引用方式

   * 内存占用，绘制的区域尺寸过大

     缓存机制，切分绘制的块大小，按比例绘制导图，图片压缩，懒加载（懒加载的缺点）

   * tableview简单优化

     预加载，加载直接读取本地图片，优化图片大小。

     参考阅读：[深入剖析Swift性能优化](https://mp.weixin.qq.com/s/U95QmOOjeXkk-yC23cuZCQ)，[iOS卡顿优化](https://juejin.im/post/6844904004053368846)，[查看当前屏幕帧数工具的实现](https://www.jianshu.com/p/878bfd38666d)

项目软技能：

1. 极难挑战的点/经历最难的业务开发

   最难的其实就是云文件和内存优化这两个点

2. 最擅长iOS哪方面知识，怎么体现出来

   目前其实没有最擅长的，都是一些业务开发，但是在富文本编辑，还有图形绘制上面积累了一些经验

3. 做过什么工作职责之外的事情

   编码规范讨论，体验竟品，提一些创意的点或者需求，体验自家产品，发现bug

4. 用过的开源库和原理了解

   SwiftLine，Alamofire，KingFisher，SnapKit

5. 对竞品的了解和分析

   Xmind，MindManager，幕布，石墨文档……

一些编程实践：

1. [一段代码的重构实践记录](https://juejin.im/post/5e01cb76f265da339260c753)
2. [Swift复杂视图多事件回调处理方案思考](https://www.jianshu.com/p/204e2d00c202)
3. [基于CoreText的排版实践](https://blog.devtang.com/2015/06/26/using-coretext-1/)