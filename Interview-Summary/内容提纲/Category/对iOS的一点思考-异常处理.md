# 对iOS的一点思考：异常处理篇

本文从异常处理机制出发，探索不同语言的异常处理机制，并介绍了如何捕获Crash，分析Crash，和OOM问题分析定位

### iOS的异常处理机制

#### Swift上的异常处理

探索Swift的异常处理机制

#### Objective-C的异常处理

探索Objective-C/C++的异常处理机制

### Crash分析

#### 捕获Crash

无论是硬件异常产生的信号，还是软件异常产生的信号，都会走到act_set_astbsd()进而唤醒收到信号的进程的某一个线程。这一机制给我们在自身进程内捕获Crash提供了可能，即通过拦截UNIX信号或Mach异常来捕获崩溃。

当我们拦截信号处理之后，可以让程序不崩溃而继续运行，但是不建议这样，这时程序已经处于异常不可知状态。

一般我们通过两种方式拦截异常，包括Mach异常拦截和UNIX信号拦截，虽然我们可以看到很多Mach异常都转换成了UNIX信号，但是基于以下的原因，我们仍然拦截了Mach异常

* 不是所有的Mach异常类型都映射到了UNIX信号，如EXC_GUARD异常
* UNIX信号在崩溃线程回调，如果遇到了stackoverflow问题，已经没有条件（栈空间）再执行回调代码

因为用户态的软件异常是直接走信号流程的，所以我们也不能认为直接拦截Mach异常就可以了。

#### 分析Crash

分析和定位Crash出现在开发者编写的代码和系统库中时，如何定位对应问题

##### 参考阅读

[了解和分析iOS Crash](https://juejin.im/post/6844903774780145678)

[汇编指令学习](https://blog.cnbluebox.com/blog/2017/07/24/arm64-start/)

### OOM问题

#### Jetsam机制探索

#### OOM问题捕获

#### 

### 